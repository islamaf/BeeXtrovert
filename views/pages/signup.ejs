<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../partials/head'); %>
</head>

<body class="container">
    <nav class="logo">
        <h1>BeeXtrovert</h1>
    </nav>
    <div class="main-div">
        <section class="signup-title">
            <h1>BeeXtrovert</h1>
            <blockquote>“He who has a why to live can bear almost any how.”</blockquote>
        </section>

        <form class="signup-form" action="/sign_up" id="signup" method="post">
            <div id="signup-heading">SIGN UP FORM</div>
            
            <!-- Edit and style -->
            <div>
                <p id="error"></p>
            </div>

            <input class="text-boxes" type="text" name="username" id="username" placeholder="Username" required>
            
            <!-- Edit and style -->
            <p id="usernameErrors"></p>

            <input class="text-boxes" type="email" name="email" id="email" placeholder="Email" required>
            <input class="text-boxes" type="password" name="password" id="password" placeholder="Password" required>

            <!-- Edit and style -->
            <p id="passwordErrors"></p>

            <div class="gender">
                <div class="gender-type">
                    <span>Gender:</span>
                </div>
                <div class="male">
                    <input type="radio" id="male" name="gender" value="male" required>
                    <label for="male">Male</label>
                </div>
                <div class="female">
                    <input type="radio" id="female" name="gender" value="female" required>
                    <label for="female">Female</label>
                </div>
            </div>
            <div class="age_identifier">
                <div class="ageLabel">
                    <label for="age">Age:</label>
                </div>
                <div class="ageSelect">
                    <select name="age" id="age">
                        <option selected disabled>Select Range</option>
                        <option value="18-22">18-22</option>
                        <option value="23-27">23-27</option>
                        <option value="28-32">28-32</option>
                        <option value="33-37">33-37</option>
                        <option value="38-42">38-42</option>
                        <option value="43-57">43-57</option>
                        <option value="58-62">58-62</option>
                    </select>
                </div>
            </div>
            <input id="submit" type="submit" value="Register" onclick=validateGender()>
            <section class="signin-link">
                <span>Already a user? <a href="/signin">Sign in</a></span>
            </section>
        </form>
    </div>

    <footer>
        <%- include('../partials/footer'); %>
    </footer>

    <script>
        function validateGender(){
            counter=0
            var sel = document.getElementById("age");
            var text= sel.options[sel.selectedIndex].text;
            if((!document.getElementById('male').checked) && (!document.getElementById('female').checked) && text== "Select Range"){
                alert("Please select your Gender and Age Range")
            }
            else if((!document.getElementById('male').checked) && (!document.getElementById('female').checked)){
                alert("Please Select your gender")
            }
            else if(text == "Select Range"){
                alert("Please Select age range")
                counter=counter+1
            }
       }
    </script>

    <script>
        $("#username").on("input", function() {
            const format = /[ `!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/;
            
            if(format.test($("#username").val()) == true){
                $('#usernameErrors').text("Username can't contain symbols");
            }
            else{
                $('#usernameErrors').text("");
            }
        });

        $("#password").on("input", function(){
            const format = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*(\W|_)).{5,}$/;

            if(format.test($("#password").val()) == true){
                $('#passwordErrors').text("");
            }else{
                $('#passwordErrors').text("Please use: 8 characters, lowercase, uppercase, symbol and a number");
            }
        })

        $(function() {
            $("#signup").on("submit", function(e) {
                e.preventDefault();
                $.ajax({
                  url: "/sign_up",
                  type: 'POST',
                  data: $(this).serialize(),
                  dataType: 'json',
                    success: function (data) {
                        if (data.error) {
                            $('#error').text(data.error);
                        }else{
                            window.location.href = data.redirect;
                        }
                    }
                })
            });
        });
    </script>
</body>

<script>
    function validateGender(){
        counter=0
        var sel = document.getElementById("age");
        var text= sel.options[sel.selectedIndex].text;
        if((!document.getElementById('male').checked) && (!document.getElementById('female').checked) && text== "Select Range"){
            alert("Please select your Gender and Age Range")
        }
        else if((!document.getElementById('male').checked) && (!document.getElementById('female').checked)){
            alert("Please Select your gender")
        }
        else if(text == "Select Range"){
            alert("Please Select age range")
            counter=counter+1
        }
   }
    
</script>
</html>